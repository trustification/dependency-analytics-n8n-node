import type { INodeProperties } from 'n8n-workflow';

export const vulnerabilityProperties: INodeProperties[] = [
	{
		displayName: 'Operation',
		name: 'operation',
		type: 'options',
		noDataExpression: true,
		displayOptions: { show: { resource: ['vulnerability'] } },
		options: [
			{ name: 'Get', value: 'get', action: 'Get a vulnerability' },
			{ name: 'Get Many', value: 'getMany', action: 'Get many vulnerabilities' },
			{ name: 'Analyze', value: 'analyze', action: 'Analyze vulnerabilities from purls or sbom' },
		],
		default: 'getMany',
	},
	{
		displayName: 'Input Type',
		name: 'inputType',
		type: 'options',
		options: [
			{ name: 'PURLs (Multiline)', value: 'purls' },
			{ name: 'SBOM Lookup (SHA-256)', value: 'sbomSha256' },
		],
		default: 'purls',
		displayOptions: { show: { resource: ['vulnerability'], operation: ['analyze'] } },
	},
	{
		displayName: 'PURLs',
		name: 'purlsRaw',
		type: 'string',
		typeOptions: { rows: 6 },
		default: '',
		placeholder:
			'["pkg:npm/lodash@4.17.21","pkg:maven/org.apache.commons/commons-text@1.10.0"]\n# or:\npkg:npm/lodash@4.17.21\npkg:maven/org.apache.commons/commons-text@1.10.0',
		description: 'Paste a JSON array of PURLs, or one PURL per line',
		displayOptions: { show: { resource: ['vulnerability'], operation: ['analyze'], inputType: ['purls'] } },
	},
	{
		displayName: 'SBOM SHA-256',
		name: 'sbomSha256',
		type: 'string',
		default: '',
		placeholder: 'e.g., 3a7bd3e2360a3dâ€¦',
		description: 'The SHA-256 checksum of the SBOM file to analyze',
		displayOptions: {
			show: { resource: ['vulnerability'], operation: ['analyze'], inputType: ['sbomSha256'] },
		},
	},
];
